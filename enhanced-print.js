// Enhanced Print Function with Dynamic CSS Extraction\nfunction enhancedPrintCV() {\n    console.log('🖨️ Starting enhanced print with CSS extraction...');\n    \n    // Update preview first\n    if (window.updatePreview) {\n        window.updatePreview();\n    }\n    \n    setTimeout(() => {\n        const cvPreviewElement = document.getElementById('cvPreview');\n        if (!cvPreviewElement) {\n            alert('Error: CV preview element not found. Please refresh and try again.');\n            return;\n        }\n        \n        const cvContent = cvPreviewElement.innerHTML;\n        if (!cvContent || cvContent.trim().length < 100) {\n            alert('Error: CV appears empty. Please fill in your details and ensure preview shows content.');\n            return;\n        }\n        \n        const fullName = (document.getElementById('fullName')?.value || 'CV').trim();\n        const scaleVal = parseInt(document.getElementById('printScale')?.value || '100', 10);\n        \n        // Extract ALL CSS from the page\n        function extractPageCSS() {\n            let allCSS = '';\n            \n            // Get all stylesheets\n            for (let i = 0; i < document.styleSheets.length; i++) {\n                try {\n                    const sheet = document.styleSheets[i];\n                    const rules = sheet.cssRules || sheet.rules;\n                    \n                    for (let j = 0; j < rules.length; j++) {\n                        const rule = rules[j];\n                        if (rule.cssText) {\n                            // Include all CV-related rules\n                            if (rule.cssText.includes('.cv') ||\n                                rule.cssText.includes('timeline') ||\n                                rule.cssText.includes('card') ||\n                                rule.cssText.includes('header') ||\n                                rule.cssText.includes('section') ||\n                                rule.cssText.includes('sidebar') ||\n                                rule.cssText.includes('photo') ||\n                                rule.cssText.includes('grid') ||\n                                rule.cssText.includes('print') ||\n                                rule.cssText.includes('@page') ||\n                                rule.cssText.includes('color-adjust')) {\n                                allCSS += rule.cssText + '\\n';\n                            }\n                        }\n                    }\n                } catch (e) {\n                    console.warn('Could not access stylesheet:', e);\n                }\n            }\n            \n            return allCSS;\n        }\n        \n        const pageCSS = extractPageCSS();\n        console.log('📄 Extracted CSS length:', pageCSS.length);\n        \n        // Open print window\n        const printWindow = window.open('', '_blank', 'width=900,height=700');\n        if (!printWindow) {\n            alert('Popup blocked! Please allow popups and try again.');\n            return;\n        }\n        \n        // Enhanced print HTML\n        const printHTML = `<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <title>CV - ${fullName}</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <style>\n        /* Global print color forcing */\n        *, *::before, *::after {\n            -webkit-print-color-adjust: exact !important;\n            print-color-adjust: exact !important;\n            color-adjust: exact !important;\n        }\n        \n        html {\n            margin: 0;\n            padding: 0;\n        }\n        \n        body {\n            margin: 0;\n            padding: 20px;\n            font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Arial, sans-serif;\n            line-height: 1.6;\n            color: #1f2937;\n            background: white;\n            -webkit-print-color-adjust: exact;\n            print-color-adjust: exact;\n        }\n        \n        @page {\n            size: A4;\n            margin: 0.5in;\n        }\n        \n        @media print {\n            body {\n                padding: 0 !important;\n                font-size: 11px !important;\n                line-height: 1.4 !important;\n            }\n            \n            * {\n                -webkit-print-color-adjust: exact !important;\n                print-color-adjust: exact !important;\n                color-adjust: exact !important;\n            }\n        }\n        \n        /* Page CSS Injection */\n        ${pageCSS}\n        \n        /* Enhanced CV base styles */\n        .cv {\n            max-width: 100% !important;\n            width: 100% !important;\n            margin: 0 auto !important;\n            font-family: inherit !important;\n            line-height: 1.6 !important;\n            color: #1f2937 !important;\n            background: white !important;\n            transform: scale(${scaleVal / 100}) !important;\n            transform-origin: top left !important;\n            ${scaleVal !== 100 ? `width: ${10000 / scaleVal}% !important;` : ''}\n        }\n        \n        /* Force header styling */\n        .cv-header {\n            display: flex !important;\n            align-items: center !important;\n            gap: 20px !important;\n            padding-bottom: 15px !important;\n            margin-bottom: 20px !important;\n            border-bottom: 2px solid #e5e7eb !important;\n            flex-direction: row-reverse !important;\n        }\n        \n        .cv-header.no-photo {\n            flex-direction: column !important;\n            align-items: flex-start !important;\n        }\n        \n        .cv-info { flex: 1 !important; }\n        \n        .cv-name {\n            font-size: 24px !important;\n            font-weight: 700 !important;\n            margin-bottom: 5px !important;\n            color: #1f2937 !important;\n        }\n        \n        .cv-title {\n            font-size: 16px !important;\n            font-weight: 600 !important;\n            color: #2563eb !important;\n            margin-bottom: 10px !important;\n        }\n        \n        .cv-contact {\n            font-size: 13px !important;\n            color: #6b7280 !important;\n        }\n        \n        .cv-photo {\n            width: 100px !important;\n            height: 100px !important;\n            border-radius: 8px !important;\n            object-fit: cover !important;\n            border: 3px solid #e5e7eb !important;\n            background: #f9fafb !important;\n        }\n        \n        /* Section styling */\n        .cv-section {\n            margin-bottom: 20px !important;\n        }\n        \n        .cv-section h3 {\n            font-size: 16px !important;\n            font-weight: 700 !important;\n            color: #1f2937 !important;\n            margin-bottom: 10px !important;\n            padding-bottom: 5px !important;\n            border-bottom: 1px solid #e5e7eb !important;\n        }\n        \n        .cv-section h4 {\n            font-size: 14px !important;\n            font-weight: 600 !important;\n            color: #374151 !important;\n        }\n        \n        .cv-section p, .cv-section li {\n            font-size: 13px !important;\n            color: #4b5563 !important;\n            line-height: 1.5 !important;\n        }\n        \n        /* Timeline styles */\n        .timeline-item {\n            margin-bottom: 15px !important;\n            padding-left: 20px !important;\n            border-left: 2px solid #e5e7eb !important;\n            position: relative !important;\n        }\n        \n        .timeline-item::before {\n            content: '' !important;\n            position: absolute !important;\n            left: -6px !important;\n            top: 5px !important;\n            width: 10px !important;\n            height: 10px !important;\n            border-radius: 50% !important;\n            background: #2563eb !important;\n        }\n        \n        /* Card styles */\n        .cv-card {\n            background: #f8fafc !important;\n            border: 1px solid #e2e8f0 !important;\n            border-radius: 8px !important;\n            padding: 15px !important;\n            margin-bottom: 15px !important;\n        }\n        \n        /* Sidebar styles */\n        .cv-sidebar {\n            background: #f1f5f9 !important;\n            padding: 20px !important;\n            border-radius: 8px !important;\n        }\n        \n        .cv-sidebar h3 {\n            color: #1e40af !important;\n            border-bottom-color: #3b82f6 !important;\n        }\n        \n        /* Header card styles */\n        .cv-header-card {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;\n            color: white !important;\n            padding: 20px !important;\n            border-radius: 8px !important;\n            margin-bottom: 20px !important;\n            text-align: center !important;\n        }\n        \n        .cv-header-card .cv-name { color: white !important; font-size: 26px !important; }\n        .cv-header-card .cv-title { color: rgba(255,255,255,0.9) !important; }\n        .cv-header-card .cv-contact { color: rgba(255,255,255,0.8) !important; }\n        \n        /* Grid layout */\n        .cv-grid {\n            display: grid !important;\n            grid-template-columns: 1fr 1fr !important;\n            gap: 20px !important;\n        }\n        \n        /* Glass effects */\n        .glass-header {\n            background: rgba(255, 255, 255, 0.25) !important;\n            backdrop-filter: blur(10px) !important;\n            border: 1px solid rgba(255, 255, 255, 0.18) !important;\n            border-radius: 12px !important;\n            padding: 20px !important;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"cv\">${cvContent}</div>\n    <script>\n        console.log('Enhanced print window loaded');\n        \n        window.onload = function() {\n            console.log('Print window ready, triggering print...');\n            setTimeout(function() {\n                window.focus();\n                window.print();\n            }, 1500);\n        };\n        \n        window.onafterprint = function() {\n            console.log('Print completed, closing window...');\n            setTimeout(function() {\n                window.close();\n            }, 1000);\n        };\n        \n        // Fallback auto-close\n        setTimeout(function() {\n            if (!window.closed) {\n                console.log('Auto-closing print window...');\n                window.close();\n            }\n        }, 30000);\n    </script>\n</body>\n</html>`;\n        \n        console.log('📝 Writing enhanced print content...');\n        printWindow.document.write(printHTML);\n        printWindow.document.close();\n        \n    }, 300);\n}\n\n// Override the existing print function if this file is loaded\nif (typeof window !== 'undefined') {\n    window.enhancedPrintCV = enhancedPrintCV;\n    \n    // Replace existing print function\n    if (window.printCV) {\n        window.originalPrintCV = window.printCV;\n    }\n    window.printCV = enhancedPrintCV;\n    \n    console.log('✅ Enhanced print function loaded and ready!');\n}